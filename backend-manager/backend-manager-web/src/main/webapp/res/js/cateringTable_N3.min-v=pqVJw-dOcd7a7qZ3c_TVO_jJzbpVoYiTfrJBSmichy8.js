function getpageCateringRegionList(n,t){var i="";$.getAsyncJson("/CateringRegion/GetCateringRegionPageList",{pageIndex:n,pageSize:100,seachStr:t},function(n){var t,r;if(n.succeed){if(t=n.values,t&&t.length>0)for(r=0;r<t.length;r++)i+='<li data-id="'+t[r].sv_region_id+'" data-name="'+t[r].sv_region_name+'">',i+='<div class="bigCategorieslist-name"><i class="icon-stop stop-type"><\/i><span>'+t[r].sv_region_name+"<\/span><\/div>",i+='<div class="editbigCategorieslist">',i+='<a href="javascript:void(0);" class="editcateringRegionList" data-id="'+t[r].sv_region_id+'" data-name="'+t[r].sv_region_name+'"><i class="icon-edit"><\/i><\/a>',i+='<a href="javascript:void(0);" class="DeleteCateringRegion " data-id="'+t[r].sv_region_id+'" data-name="'+t[r].sv_region_name+'"><i class="icon-remove"><\/i><\/a>',i+="<\/div><\/li>"}else commondResultMsg(n.errmsg);$("#cateringRegionListHtml").html(i)})}function btnEditRegion(){$(document).on("click","#btnEditRegion",function(){var t=$("#_regionName").attr("data-id"),n=$("#_regionName").val().replace(/\ +/g,"");if(!isNullOrWhiteSpace(n)){$("#_regionName").focus();layer.msg("\u533a\u57df\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a\uff01");return}if(n.length>25){$("#_regionName").focus();layer.msg("\u533a\u57df\u540d\u79f0\u4e0d\u80fd\u5927\u4e8e25\u4e2a\u5b57\u7b26\uff01");return}$.postAsyncJson("/CateringRegion/OperateCateringRegion",{sv_region_id:t,sv_region_name:n,sv_enabled:!0,sv_remark:""},function(n){n.succeed?(layer.closeAll(),commondResultMsg("\u4fdd\u5b58\u6210\u529f\u533a\u57df\u4fe1\u606f",1,800),$("#_regionName").val(""),getpageCateringRegionList(1,"")):($("#_regionName").val(""),commondResultMsg(n.errmsg,2,800))})})}function areaTnformationFn(){var n=$("#cateringRegionListHtml li.active").attr("data-id");$("#sv_region_id").find("option[value="+n+"]").attr("selected",!0)}function funcBatchOpenTable(){var n=$("#cateringRegionListHtml li.active").attr("data-id");isNullOrWhiteSpace(n)&&$("#sv_region_id").val(n)}function pageCateringTable(n,t,i){var r=20;$.get("/CateringTable/GetCateringTableTotal/",{regionId:n,seachStr:t,storeUserId:i},function(u){if(u.succeed){var f=Math.ceil(u.values/r);laypage({cont:$("#pageCateringTableList"),pages:f,skin:"molv",skip:!0,first:"\u9996\u9875",last:"\u5c3e\u9875",prev:"\u4e0a\u4e00\u9875",next:"\u4e0b\u4e00\u9875",jump:function(u){getCateringTablePageList(n,u.curr,r,t,i)}})}})}function getCateringTablePageList(n,t,i,r,u){var f="",e=commonOpenLoading();$.getAsyncJson("/CateringTable/GetCateringTablePageList",{regionId:n,pageIndex:t,pageSize:i,seachStr:r,storeUserId:u},function(n){var i,t,u,r,o;if(commonCloseLoading(e),n.succeed&&n.values!=null&&n.values.length>0){for(i=n.values,t=0;t<i.length;t++)u=i[t].sv_enabled==!0?"\u542f\u7528":"\u505c\u7528",r=i[t].sv_table_using_state==0?"\u7a7a\u95f2":"\u4f7f\u7528\u4e2d",f+='<li class="col-xs-4 col-sm-4 col-md-3">',f+='<div class="tablelcenter">',f+='<span class="number">'+i[t].sv_table_name+"<\/span>",f+='<div class="edittablel">',f+='<i class="icon-edit edittype updateCateringTable" data-state="'+r+'" data-id="'+i[t].sv_table_id+'"><\/i>',f+='<i class="icon-remove edittype btnDeleteCateringTable" data-state="'+r+'" data-id="'+i[t].sv_table_id+'"><\/i>',f+="<\/div>",f+=i[t].sv_enabled?'<div class="shopstatus"><span class="enabled">'+u+"<\/span><\/div>":'<div class="shopstatus"><span class="stop">'+u+"<\/span><\/div>",f+='<div class="Businessstatus" style="width: 50%;"><span class="use">'+r+"<\/span><\/div>",f+='<div class="Businessstatus1" style="width: 50%;"><button type="button" class="btn  icon-qrcode" data-id="'+i[t].sv_table_id+'" data-name="'+i[t].sv_table_name+'"><\/button><\/div>',f+="<\/div><\/li>";$("#cateringTableListHtml").html(f)}else o=$("#cateringRegionListHtml li.active").attr("data-id"),o>0?$("#cateringTableListHtml").html("<li>\u8be5\u533a\u57df\u8fd8\u6ca1\u6709\u6dfb\u52a0\u623f\u53f0\uff01<\/li>"):$("#cateringTableListHtml").html("<li>\u8fd8\u6ca1\u6709\u6dfb\u52a0\u623f\u53f0\uff01<\/li>")})}function tableEditInfo(){}$(function(){getpageCateringRegionList(1,"");pageCateringTable(0,"","")});$(document).unbind("click",".check-box").on("click",".check-box",function(){$("#userid").val($(this).find("input").data("user_id"));$(this).find("input").prop("checked")?($("#userid").val(""),$(this).find("input").prop("checked",!1),$(this).removeClass("checkedBox"),$("#checkAll").find("input").prop("checked",!1),$("#checkAll").removeClass("checkedBox")):($('input[name="subbox"]').prop("checked",!1),$('input[name="subbox"]').parent().parent().removeClass("checkedBox"),$(this).find("input").prop("checked",!0),$(this).addClass("checkedBox"),$('input[name="subbox"]:checked').length==$('input[name="subbox"]').length&&($("#checkAll").find("input").prop("checked",!0),$("#checkAll").addClass("checkedBox")));$(".checkedBox").length>0?$(".unlinks li").addClass("active"):$(".unlinks li").removeClass("active")});$("#txtCateringRegion").keypress(function(n){n.keyCode==13&&$("#btnCateringRegion").click()});$("#btnCateringRegion").click(function(){var t=$("#txtCateringRegion").attr("data-id"),n=$("#txtCateringRegion").val().replace(/\ +/g,"");if(!isNullOrWhiteSpace(n)){$("#txtCateringRegion").focus();layer.msg("\u533a\u57df\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a\uff01");return}if(n.length>25){$("#txtCateringRegion").focus();layer.msg("\u533a\u57df\u540d\u79f0\u4e0d\u80fd\u5927\u4e8e25\u4e2a\u5b57\u7b26\uff01");return}$.postAsyncJson("/CateringRegion/OperateCateringRegion",{sv_region_id:t,sv_region_name:n,sv_enabled:!0,sv_remark:""},function(n){n.succeed?(commondResultMsg("\u4fdd\u5b58\u6210\u529f\u533a\u57df\u4fe1\u606f",1,800),$("#txtCateringRegion").val(""),getpageCateringRegionList(1,"")):($("#txtCateringRegion").val(""),commondResultMsg(n.errmsg,2,800))})});$(document).on("click","#cateringRegionListHtml li",function(){$(this).addClass("active").siblings("li").removeClass("active");var n=$(this).attr("data-id");pageCateringTable(n,"","")});var editcateringRegionListHtml='<div class="determine" style="height:80px;padding:15px;"><input type="text" class="form-control" id="_regionName" placeholder="\u8f93\u5165\u623f\u53f0\u540d\u79f0" /><\/div><footer class="determinebtn-closebtn"><div class="btnbox fr"><button type="button" class="btn btn-success review-btn" id="btnEditRegion">\u786e\u5b9a<\/button><button type="button" class="btn btn-default closepage" onClick="layer.closeAll()">\u53d6\u6d88<\/button><\/div><\/footer>';$(document).unbind("click",".editcateringRegionList").on("click",".editcateringRegionList",function(){var n=$(this).attr("data-name"),t=$(this).attr("data-id");layer.open({type:1,area:["380px","180px"],btn:!1,content:editcateringRegionListHtml});$("#_regionName").val(n);$("#_regionName").attr("data-id",t);btnEditRegion()});$(document).on("click",".DeleteCateringRegion ",function(){var n=$(this).attr("data-id"),t=$(this).attr("data-name");n>0?layer.confirm("\u662f\u5426\u5220\u9664\u201c"+t+"\u201d\u8fd9\u4e2a\u533a\u57df\u53ca\u533a\u57df\u4e0b\u6240\u6709\u7684\u623f\u53f0\u6570\u636e\uff01",{btn:["\u662f","\u5426"]},function(){$.postAsyncJson("/CateringRegion/DeleteCateringRegion",{regionId:n},function(n){n.succeed?(commondResultMsg("\u5220\u9664\u533a\u57df\u6210\u529f\uff01",1,1500),getpageCateringRegionList(1,""),pageCateringTable(0,"","")):commondResultMsg(n.errmsg,2,1500)})},function(){}):commondResultMsg("\u8bf7\u9009\u62e9\u8981\u5220\u9664\u7684\u623f\u53f0",3,1500)});$(document).on("mouseover","#cateringRegionListHtml li",function(){$(this).addClass("showbg");$(this).children(".editbigCategorieslist").addClass("show");$(this).children(".bigCategorieslist-name").addClass("paddright")});$(document).on("mouseout","#cateringRegionListHtml li",function(){$(this).removeClass("showbg");$(this).hasClass("active")||($(this).children(".editbigCategorieslist").removeClass("show"),$(this).children(".bigCategorieslist-name").removeClass("paddright"))});$("#btnOpenTableEditWindows").click(function(){layerpage.Deke_layerpage.show_Url2("1","\u65b0\u589e\u623f\u53f0","/CateringTable/_PartialOperateTable?tableId=0",["400px","370px"],areaTnformationFn)});$(document).unbind("click","#btnSaveTable").on("click","#btnSaveTable",function(){var f=/^\+?[0-9][0-9]*$/,t=$("#sv_table_name").val().replace(/\ +/g,""),i=$("#sv_table_number").val().replace(/\ +/g,""),e=$("#sv_table_sort").val().replace(/\ +/g,""),u=$("#sv_region_id").val(),s=$("#sv_enabled").is(":checked"),h=$("#sv_table_id").val(),r=$("#sv_batch_add_number").val(),n=eval($("#isBatchAddTable").val()),o;if(!n&&!isNullOrWhiteSpace(t)){layer.msg("\u8bf7\u8f93\u5165\u623f\u53f0\u540d\u79f0");$("#sv_table_name").focus();return}if(n&&!isNullOrWhiteSpace(t)){layer.msg("\u8bf7\u8f93\u5165\u623f\u53f0\u524d\u7f00");$("#sv_table_name").focus();return}if(n&&t.length>2){layer.msg("\u8bf7\u8f93\u51652\u4e2a\u5b57\u7b26\u4ee5\u5185\u7684\u6570\u5b57\u6216\u5b57\u6bcd\uff01");$("#sv_table_name").focus();return}if(!n&&t.length>20){layer.msg("\u623f\u53f0\u540d\u79f0\u5b57\u7b26\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc720\u4e2a\u5b57\uff01");$("#sv_table_name").focus();return}if(!isNullOrWhiteSpace(i)){layer.msg("\u8bf7\u8f93\u5165\u5bb9\u7eb3\u4eba\u6570\uff01");$("#sv_table_number").focus();return}if(parseInt(i)<=0){layer.msg("\u8bf7\u8f93\u5165\u5927\u4e8e\u96f6\u7684\u5bb9\u7eb3\u4eba\u6570\uff01");$("#sv_table_number").focus();return}if(!f.test(i)){layer.msg("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u5bb9\u7eb3\u4eba\u6570\u4e14\u4e3a\u6b63\u6574\u6570\uff01");$("#sv_table_number").focus();return}if(n&&!isNullOrWhiteSpace(r)){layer.msg("\u8bf7\u8f93\u5165\u8981\u6279\u91cf\u589e\u52a0\u623f\u53f0\u7684\u6570\u91cf\uff01");$("#sv_batch_add_number").focus();return}if(n&&(parseInt(r)<=0||parseInt(r)>100)){layer.msg("\u6279\u91cf\u589e\u52a0\u623f\u53f0\u7684\u6570\u91cf\u53ea\u80fd\u8f93\u51651\u5230100");$("#sv_batch_add_number").focus();return}if(!f.test(e)){layer.msg("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u6392\u5e8f\u6570\u5b57\u4e14\u4e3a\u6b63\u6574\u6570\uff01");return}if(u==0||u=="0"){layer.msg("\u8bf7\u9009\u62e9\u623f\u53f0\u6240\u5c5e\u533a\u57df\uff01");return}o=commonOpenLoading();$.postAsyncJson("/CateringTable/OperateTable",{sv_table_id:h,sv_table_name:t,sv_table_number:i,sv_table_sort:e,sv_region_id:u,sv_store_user_id:user_id,sv_enabled:s,sv_batch_add_number:r,isBatchAddTable:n},function(t){if(commonCloseLoading(o),t.succeed){n&&t.errmsg!=null&&t.errmsg!=""?commondResultMsg(t.errmsg,1,3e3):commondResultMsg("\u4fdd\u5b58\u623f\u53f0\u4fe1\u606f\u6210\u529f",1,2e3);var i=$("#cateringRegionListHtml li.active").attr("data-id");isNullOrWhiteSpace(i)?pageCateringTable(i,"",""):pageCateringTable(0,"","");setTimeout(function(){layer.closeAll()},500)}else t.errmsg==null?(commondResultMsg("\u4fdd\u5b58\u5931\u8d25\u8bf7\u7a0d\u540e\u91cd\u8bd5",2,1e3),setTimeout(function(){layer.closeAll()},500)):layer.msg(t.errmsg)})});$(document).on("click","#btnBatchOpenTableEditWindows",function(){layerpage.Deke_layerpage.show_Url2("1","\u6279\u91cf\u589e\u52a0\u623f\u53f0","/CateringTable/_PartialOperateTable?tableId=0&&isBatchAdd=true",["400px","470px"],funcBatchOpenTable)});$(document).on("click",".updateCateringTable",function(){var n=$(this).attr("data-id");n>0?layerpage.Deke_layerpage.show_Url2("1","\u4fee\u6539\u623f\u53f0","/CateringTable/_PartialOperateTable?tableId="+n,["400px","370px"],tableEditInfo()):commondResultMsg("\u8bf7\u9009\u62e9\u7f16\u8f91\u7684\u623f\u53f0",3,3e3)});$(document).on("click",".btnDeleteCateringTable",function(){var n=$(this).attr("data-id"),t=$(this).attr("data-state");n>0?layer.confirm("\u662f\u5426\u786e\u8ba4\u5220\u9664\u8be5\u623f\u53f0\uff1f",{btn:["\u662f","\u5426"]},function(){t==1?commondResultMsg("\u8be5\u623f\u53f0\u6b63\u5728\u8425\u4e1a\u4e2d\u4e0d\u80fd\u8fdb\u884c\u5220\u9664\u64cd\u4f5c\uff01",2,1500):$.postAsyncJson("/CateringTable/DeleteTable",{tableId:n},function(n){if(n.succeed){commondResultMsg("\u5220\u9664\u623f\u53f0\u6210\u529f\uff01",1,1500);var t=$("#cateringRegionListHtml li.active").attr("data-id");isNullOrWhiteSpace(t)?pageCateringTable(t,"",""):pageCateringTable(0,"","")}else commondResultMsg(n.errmsg,2,1500)})},function(){}):commondResultMsg("\u8bf7\u9009\u62e9\u8981\u5220\u9664\u7684\u623f\u53f0",3,1500)});$("#refreshCateringTable").click(function(){pageCateringTable(0,"","")});$(document).unbind("click","#btnCancel").on("click","#btnCancel",function(){layer.closeAll()});$("#StoreShopList").change(function(){var n=$(this).val(),t=$("#cateringRegionListHtml li.active").attr("data-id");isNullOrWhiteSpace(t)?pageCateringTable(t,"",n):pageCateringTable(0,"",n)});$("#btnSeachTable").keypress(function(n){if(n.keyCode==13){var t=$(this).val().replace(/\ +/g,"");isNullOrWhiteSpace(t)?pageCateringTable(0,t,""):commondResultMsg("\u8bf7\u8f93\u5165\u8981\u67e5\u8be2\u7684\u623f\u53f0\u540d\u79f0",3,800)}});$("#buttonSeachTable").click(function(){var n=$("#btnSeachTable").val().replace(/\ +/g,"");n?pageCateringTable(0,n,""):commondResultMsg("\u8bf7\u8f93\u5165\u8981\u67e5\u8be2\u7684\u623f\u53f0\u540d\u79f0",3,800)});$(document).unbind("click","#cateringTableListHtml>li .icon-qrcode").on("click","#cateringTableListHtml>li .icon-qrcode",function(){var n=$(this).attr("data-id"),t=$(this).attr("data-name");n>0&&$.post("/CateringTable/GenerateCodeToBase64Img",{tableId:n},function(n){if(n){var i="<div class=\"wxsaosao text-center\"><div><br><\/div><img style='padding-bottom: 20px;' src="+n+' width="240" class="bbimg"><div style="text-align:center;"><a href='+n+' target="_blank">\u4e0b\u8f7d\u56fe\u7247<\/a><\/div><\/div>';layer.open({type:1,title:t+"\u4e8c\u7ef4\u7801",area:["400px","400px"],content:i})}else layer.msg("\u751f\u6210\u4e8c\u7ef4\u7801\u5931\u8d25\uff0c\u8bf7\u5237\u65b0\u540e\u518d\u8bd5")})});$("#btnBatchOpenTableDownLoad").click(function(){var n=commonOpenLoading();$.post("https://res.decerp.cc/api/Images/DownLoadCateringTableImgs?userId="+user_id,function(t){commonCloseLoading(n);t&&t.succeed?commonDownloadFile("https://res.decerp.cc"+t.values):layer.msg("\u4e0b\u8f7d\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01")})});