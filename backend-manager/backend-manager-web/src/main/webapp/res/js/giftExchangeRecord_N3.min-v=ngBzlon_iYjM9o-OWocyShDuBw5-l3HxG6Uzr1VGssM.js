$(document).ready(function(){redeemList.redeemListPage("","","","","");redeemList.shareOperating();redeemList.exportRecord()});var pageSize=10,redeemList={redeemListPage:function(n,t,i,r,u){$.get("/GiftExchange/Total/",{seach:n,member_id:t,userid:$("#userid").val(),dateday:i,Startdate:r,Enddate:u},function(f){var e=Math.ceil(f/pageSize);laypage({cont:$("#pageGro"),pages:e,skin:"molv",skip:!0,first:"\u9996\u9875",last:"\u5c3e\u9875",prev:"\u4e0a\u4e00\u9875",next:"\u4e0b\u4e00\u9875",jump:function(f){pageinxe=f.curr;redeemList.getRedeemList(f.curr,n,t,i,r,u);e>1?(addPageSizeFn("#selectpagesize"),$("#pagesize").find("option[value='"+pageSize+"']").attr("selected",!0)):$("#selectpagesize").html("")}})})},getRedeemList:function(n,t,i,r,u,f){$.getJSON("/GiftExchange/PageList/",{pageIndex:n,seach:t,member_id:i,pageSize:pageSize,userid:$("#userid").val(),dateday:r,Startdate:u,Enddate:f},function(n){var i,t,r;if(n!=null&&n.length>0){for(i="",t=0;t<n.length;t++)for(t=0;t<n.length;t++)i+="<tr>",i+="<td>"+n[t].sv_mr_cardno+"<\/td>",i+='<td class="amountcolor2">'+n[t].sv_mr_name+"<\/td>",i+="<td>"+n[t].sv_giftname+"<\/td>",i+="<td>"+n[t].sv_giftchangenumber+n[t].sv_gift_unit+"<\/td>",i+='<td class="colorff">'+n[t].sv_creditsexchange+"<\/td>",i+='<td class="minhide">'+n[t].consumeusername+"<\/td>",i+="<td>"+n[t].memberuserName+"<\/td> ",i+=n[t].sv_operatorname!=null?"<td>"+n[t].sv_operatorname+"<\/td> ":"<td><\/td> ",i+='<td class="minhide">'+new Date(n[t].sv_creationdate).Format("yyyy-MM-dd hh:mm:ss")+"<\/td>",i+="<\/tr>";$("#redeemlistHtml").html(i)}else r=$("#rowlength").children("th").length,$("#redeemlistHtml").html('<tr><td class="sad" style="text-align: center !important;" colspan="'+r+'"><img src="../skin_N3/images/sad.png" /><i class="padd0">\u6682\u65e0\u6570\u636e<\/i><\/td><\/tr>')})},shareOperating:function(){$(document).on("change","#pagesize",function(){pageSize=$(this).val();redeemList.redeemListPage("","","","","")});$("#querydate>li").click(function(){var n=$(this).attr("data-dateType"),t=$("#query_member").val().trim();if($(this).addClass("active").siblings("li").removeClass("active"),n!=-1)$("#queryortherdate").hide(0),redeemList.redeemListPage(t,"",n,"","");else return $("#queryortherdate").show(0),!1});$("#otherday").click(function(){var n=$("#querydate>li.active").attr("data-dateType"),t=$("#begindateval").val().trim(),i=$("#enddateval").val().trim(),r=$("#query_member").val().trim();redeemList.redeemListPage(r,"",n,t,i)});$("#begindate").datetimepicker({language:"zh",weekStart:1,todayBtn:1,autoclose:1,todayHighlight:1,startView:2,minView:2,forceParse:0,endDate:new Date,pickerPosition:"bottom-left",format:"yyyy/mm/dd"}).on("change",function(){var n=$("#begindateval").val();$("#enddate").datetimepicker("setStartDate",n);$("#begindate").datetimepicker("hide")});$("#enddate").datetimepicker({language:"zh",weekStart:1,todayBtn:1,autoclose:1,todayHighlight:1,startView:2,minView:2,forceParse:0,startDate:$("#startDate").val(),endDate:new Date,pickerPosition:"bottom-left",format:"yyyy/mm/dd"}).on("change",function(){var n=$("#enddateval").val();$("#begindate").datetimepicker("setReturnDate",n);$("#enddate").datetimepicker("hide")});$("#query_member").keydown(function(n){var t,i;n.keyCode==13?redeemList.redeemListPage($(this).val(),"","","",""):n.keyCode==113&&(t=typeof Cef,t!=undefined&&(GetICCardEventData($("#query_member"),n),$("#query_member").val()&&(i=$("#query_member").val(),redeemList.redeemListPage(i,"","","",""))))});$("#query_member_btn").click(function(){var n=$("#query_member").val().trim();n!=""?redeemList.redeemListPage(n,"","","",""):layer.msg("\u8bf7\u8f93\u5165\u67e5\u8be2\u7684\u5185\u5bb9\uff01")})},exportRecord:function(){$("#exportRecord").click(function(){$.getJSON("/GiftExchange/PageList/",{pageIndex:-1,seach:$("#query_member").val().trim(),member_id:"",userid:$("#userid").val(),dateday:$("#querydate>li.active").attr("data-dateType"),Startdate:$("#begindateval").val().trim(),Enddate:$("#enddateval").val().trim(),isexport:1},function(n){n==-2?layer.msg("\u4f60\u6ca1\u6709\u8be5\u64cd\u4f5c\u6743\u9650\uff01"):n!=0?(location.href=n,Cef.Download(n)):layer.msg("\u6570\u636e\u5bfc\u51fa\u5931\u8d25!")})})}};