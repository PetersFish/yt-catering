$(document).ready(function(){productProcurement.getProcurementPage();productProcurement.operating();productProcurement.addNewPurchase()});var pageSize=10,checkedProductId={},checkedProductValue=[],thisPageIndex=1,productProcurement={getProcurementPage:function(n){var t="",r=$("#query_like_inputx").val(),i=0,u,f;$("#chosen>li.active").each(function(){var r=$(this).data("name"),n=$(this).data("id");switch(r){case"filterDay":i=n;break;case"filterDate":t=n}});thisPageIndex>1?(u=$("#productlist input[name='checkedpurchase']:checked").length,f=$("#productlist input[name='checkedpurchase']").length,f-u>0?(n=thisPageIndex,productProcurement.getProcurementList(n,t,r,i)):(n=thisPageIndex-1,productProcurement.getProcurementList(n,t,r,i))):productProcurement.getProcurementList(1,t,r,i);$.get("/supplier/get_procurementcount/?date="+t+"&key="+r+"&day="+i,function(u){var f=Math.ceil(u/pageSize);laypage({cont:"pageGro",pages:f,skin:"molv",skip:!0,curr:n||1,first:"\u9996\u9875",last:"\u5c3e\u9875",prev:"\u4e0a\u4e00\u9875",next:"\u4e0b\u4e00\u9875",jump:function(n,u){thisPageIndex=n.curr;u||productProcurement.getProcurementList(n.curr,t,r,i)}})})},getProcurementList:function(n,t,i,r){function u(n){switch(n){case 0:return"\u5f85\u5165\u5e93";case 2:return"\u53d6\u6d88";case 1:return"\u5df2\u5165\u5e93"}}$.getJSON("/supplier/get_procurement",{page:n,date:t,key:i,day:r,top:pageSize},function(n){var i,t,h,r,s,f,o,e,c;if(n&&n.length>0){for(i="",t=0;t<n.length;t++)if(h=new Date(n[t].sv_pc_date).Format("yyyy-MM-dd"),n[t].Prlist=n[t].prlist,n[t].Prlist.length==1)i+='<tr class="wait-hover" data-id="'+n[t].sv_pc_noid+'">',i+='<td><input data-id="'+n[t].sv_pc_noid+'" data-state="'+n[t].sv_pc_state+'" class="checkinput" type="radio" name="checkedpurchase" id="" value="" /><\/td>',i+="<td>"+n[t].sv_pc_noid+"<\/td>",i+=isNullOrWhiteSpace(n[t].sv_suname)?'<td class="amountcolor2">'+n[t].sv_suname+"<\/td>":'<td class="amountcolor2"><\/td>',i+=isNullOrWhiteSpace(n[t].Prlist[0].sv_p_name)?"<td>"+n[t].Prlist[0].sv_p_name+"<\/td>":"<td><\/td>",console.log(),o=n[t].Prlist[0].sv_p_unit!=null&&n[t].Prlist[0].sv_p_unit!=""?n[t].Prlist[0].sv_p_unit:"",i+='<td class="minhide"><span>'+o+"<\/span><\/td>",e=n[t].Prlist[0].sv_pricing_method==1?n[t].Prlist[0].sv_p_weight:n[t].Prlist[0].sv_pc_pnumber,i+="<td>\u00a5"+parseFloat(n[t].Prlist[0].sv_pc_price).toFixed(2)+"<\/td>",i+="<td><span>"+e+"<\/span><\/td>",i+="<td><i>\u00a5"+parseFloat(n[t].sv_pc_combined).toFixed(2)+"<\/i><\/td>",i+='<td class="colorff"><i>\u00a5'+parseFloat(n[t].sv_pc_realpay).toFixed(2)+"<\/i><\/td>",i+='<td class="minhide"><span>'+n[t].sv_pc_settlement+"<\/span><\/td>",i+='<td class="waitstock"> <i>'+u(n[t].sv_pc_state)+"<\/i>",n[t].sv_pc_state==0&&(i+='<div class="waitstock-btn">',i+='<button data-sate="1" type="button" data-id="'+n[t].sv_pc_noid+'" class="btn shareOperatingBtn success-review">\u5ba1\u6838<\/button>',i+="<\/div>"),i+="<\/td>",i+='<td class="minhide"><span>'+n[t].userName+"<\/span><\/td>",i+='<td class="minhide"><span>'+h+"<\/span><\/td>",i+='<td class="changeproductbuy" data-id="'+n[t].sv_pc_noid+'">',n[t].sv_pc_state==0&&(i+='<a href="javascript: void(0);" data-purchase_id="'+n[t].sv_pc_noid+'" class="amountcolor2 editpurchase">\u4fee\u6539<\/a>'),i+='<a href="javascript: void(0);" data-purchase_id="'+n[t].sv_pc_noid+'" class="amountcolor2 purchaseRetuenDetails">\u8be6\u60c5<\/a>',i+='<a href="javascript: void(0);" data-purchase_id="'+n[t].sv_pc_noid+'" class="amountcolor2 copypurchase">\u590d\u5236\u65b0\u589e<\/a>',n[t].sv_pc_state!=0&&(i+=e<=0?'<a class="amountcolor2" href="javascript:void(0);">\u5df2\u9000\u8d27<\/a>':'<a href="javascript:void(0);" data-purchase_id="'+n[t].sv_pc_noid+'" class="amountcolor2 returnPurchaseGoods">\u9000\u8d27<\/a>'),i+="<\/td>",i+=" <\/tr>";else{for(r="",s=0,f=0;f<n[t].Prlist.length;f++)r+='<tr class="hideproduct bordertopnone gesture" data-id= "'+n[t].sv_pc_noid+'">',r+="<td><\/td>",r+="<td><\/td>",r+="<td><\/td>",r+="<td><span>"+n[t].Prlist[f].sv_p_name+"<\/span><\/td>",o=n[t].Prlist[f].sv_p_unit!=null&&n[t].Prlist[f].sv_p_unit!=""?n[t].Prlist[f].sv_p_unit:" ",r+='<td class="minhide"><span>'+o+"<\/span><\/td>",e=n[t].Prlist[f].sv_pricing_method==1?n[t].Prlist[f].sv_p_weight:n[t].Prlist[f].sv_pc_pnumber,r+="<td>\u00a5"+parseFloat(n[t].Prlist[f].sv_pc_price).toFixed(2)+"<\/td>",r+="<td><span>"+e+"<\/span><\/td>",r+="<td><i>\u00a5"+parseFloat(n[t].Prlist[f].sv_pc_combined||0).toFixed(2)+"<\/i><\/td>",r+='<td class="colorff"><i>\u00a5'+parseFloat(n[t].Prlist[f].sv_paid_in_amount||0).toFixed(2)+"<\/i><\/td>",r+="<td><\/td>",r+='<td class="minhide"><\/td>',r+='<td class="minhide"><\/td>',r+='<td class="minhide"><\/td>',r+="<td><\/td>",r+="<\/tr>",s+=e;i+='<tr class="moreProudct wait-hover gesture" data-id="'+n[t].sv_pc_noid+'">';i+='<td><input data-id="'+n[t].sv_pc_noid+'" data-state="'+n[t].sv_pc_state+'" class="checkinput" type="radio" name="checkedpurchase" id="" value="" /><\/td>';i+='<td class="gesture">'+n[t].sv_pc_noid+"<\/td>";i+=isNullOrWhiteSpace(n[t].sv_suname)?'<td class="amountcolor2">'+n[t].sv_suname+"<\/td>":'<td class="amountcolor2"><\/td>';n!=null&&n.length>t&&n[t].Prlist!=null&&n[t].Prlist.length>0&&n[t].Prlist[0]!=null&&n[t].Prlist[0].sv_p_name!=null?(i+='<td class="moretext">',i+='<div class="needdisplaynone fl colorff">\u672c\u6b21\u91c7\u8d2d\u5546\u54c1:<span class="morepurchase multiplepen">\u591a\u4e2a<i class="icon-chevron-down male5 moreproduct" style="color:white;"><\/i><\/span><\/div>',i+='<div class="needdisplaynone2 fl">'+n[t].Prlist[0].sv_p_name+'<span class="morepurchase multiplepen">\u591a\u4e2a<\/span><\/div>',i+="<\/td>"):i+='<td><div class="needdisplaynone2 fl"><span class="morepurchase multiplepen"><\/span><\/div><\/td>';o="";n!=null&&n.length>t&&n[t].Prlist!=null&&n[t].Prlist.length>0&&n[t].Prlist[0]!=null&&(o=n[t].Prlist[0].sv_p_unit!=null&&n[t].Prlist[0].sv_p_unit!=""?n[t].Prlist[0].sv_p_unit:"");i+='<td class="minhide"><span class="needdisplaynone2">'+o+"<\/span><\/td>";e="";n!=null&&n.length>t&&n[t].Prlist!=null&&n[t].Prlist.length>0&&n[t].Prlist[0]!=null&&(e=n[t].Prlist[0].sv_pricing_method==1?n[t].Prlist[0].sv_p_weight:n[t].Prlist[0].sv_pc_pnumber);i+=n!=null&&n.length>t&&n[t].Prlist!=null&&n[t].Prlist.length>0&&n[t].Prlist[0]!=null&&n[t].Prlist[0].sv_pc_combined!=null?'<td><span class="needdisplaynone2">\u00a5'+parseFloat(n[t].Prlist[0].sv_pc_price).toFixed(2)+"<span><\/td>":'<td><span class="needdisplaynone2 colorff">\u00a50.00<\/span><\/td>';i+='<td><span class="needdisplaynone2">'+e+'<\/span><span class="needdisplaynone">'+s+"<\/span><\/td>";i+=n!=null&&n.length>t&&n[t].Prlist!=null&&n[t].Prlist.length>0&&n[t].Prlist[0]!=null&&n[t].Prlist[0].sv_pc_combined!=null?'<td><i class="needdisplaynone">\u00a5'+parseFloat(n[t].sv_pc_combined).toFixed(2)+'<\/i><i class="needdisplaynone2">\u00a5'+parseFloat(n[t].Prlist[0].sv_pc_combined||0).toFixed(2)+"<\/i><\/td>":'<td><i class="needdisplaynone">\u00a5'+parseFloat(n[t].sv_pc_combined).toFixed(2)+'<i class="needdisplaynone2">\u00a50.00<\/i><\/td>';i+='<td class="colorff"><i class="needdisplaynone">\u00a5'+parseFloat(n[t].sv_pc_realpay).toFixed(2)+'<\/i><i class="needdisplaynone2">\u00a5'+parseFloat(n[t].Prlist[0].sv_pc_realpay||0).toFixed(2)+"<\/i><\/td>";i+='<td class="minhide"><span>'+n[t].sv_pc_settlement+"<\/span><\/td>";i+='<td class="waitstock"><i>'+u(n[t].sv_pc_state)+"<\/i>";n[t].sv_pc_state==0&&(i+='<div class="waitstock-btn">',i+='<button data-sate="1" data-id="'+n[t].sv_pc_noid+'" type="button" class="btn shareOperatingBtn success-review">\u5ba1\u6838<\/button>',i+="<\/div>");i+="<\/td>";i+='<td class="minhide"><span>'+n[t].userName+"<\/span><\/td>";i+='<td class="minhide">'+h+"<\/td>";i+='<td class="changeproductbuy" data-id="'+n[t].sv_pc_noid+'">';n[t].sv_pc_state==0&&(i+='<a href="javascript: void(0);" data-purchase_id="'+n[t].sv_pc_noid+'" class="amountcolor2 editpurchase">\u4fee\u6539<\/a>');i+='<a href="javascript: void(0);" data-purchase_id="'+n[t].sv_pc_noid+'" class="amountcolor2 purchaseRetuenDetails">\u8be6\u60c5<\/a>';i+='<a href="javascript: void(0);" data-purchase_id="'+n[t].sv_pc_noid+'" class="amountcolor2 copypurchase">\u590d\u5236\u65b0\u589e<\/a>';n[t].sv_pc_state!=0&&(i+=s<=0?'<a class="amountcolor2" href="javascript:void(0);">\u5df2\u9000\u8d27<\/a>':'<a href="javascript:void(0);" data-purchase_id="'+n[t].sv_pc_noid+'" class="amountcolor2 returnPurchaseGoods">\u9000\u8d27<\/a>');i+="<\/td>";i+="<\/tr>";i+=r}$("#productlist").html(i);$(".wait-hover").hover(function(){$(this).children(".waitstock").children(".waitstock-btn").fadeIn(150)},function(){$(this).children(".waitstock").children(".waitstock-btn").fadeOut(150)})}else c=$("#rowlength").children("th").length,$("#productlist").html('<tr><td class="text-center sad" style="text-align:center !important;" colspan="'+c+'"><img src="../skin_N3/images/sad.png" /><i class="padd0">\u6682\u65e0\u91c7\u8d2d\u6570\u636e<\/i><\/td><\/tr>')})},operating:function(){$(document).unbind("click",".moreProudct>td:nth-child(4)").on("click",".moreProudct>td:nth-child(4)",function(){var n=$(this).parent().attr("data-id");$(this).parent().hasClass("open")?($(this).parent().removeClass("open"),$(this).parent().find(".needdisplaynone").hide(0),$(this).parent().find(".needdisplaynone2").show(0),$('.hideproduct[data-id="'+n+'"]').css("display","none")):($(this).parent().addClass("open"),$(this).parent().find(".needdisplaynone2").hide(0),$(this).parent().find(".needdisplaynone").show(0),$('.hideproduct[data-id="'+n+'"]').css("display","table-row"))});selectPurcharesDateReminderTime("begindate");$(document).unbind("click","#filterDay>li,#filterDate>li").on("click","#filterDay>li,#filterDate>li",function(){var t=$(this).hasClass("on"),i=$(this).hasClass("active"),r=$(this).hasClass("cl"),u=$(this).find("input").length,n;t||(i?$(this).data("id")!=-1&&($(this).removeClass("active"),$('#chosen>li[data-name="'+$(this).data("name")+'"').remove(),$("[data-id='0'][data-name='"+$(this).data("name")+"']").addClass("active")):($("#chosen").show(0),$(this).addClass("active").siblings("li").removeClass("active"),u==0&&(r&&(n=$(this).data("id"),readyInfo.secondCategory(n)),$(this).data("name")=="storageFilter"&&($("#minStorage").val(""),$("#maxStorage").val("")),$(this).data("name")=="adddateFilter"&&($("#startDate").val(""),$("#endDate").val("")),$('#chosen>li[data-name="'+$(this).data("name")+'"').remove(),chosenHtml=$(this).clone(!0),chosenHtml.appendTo("#chosen"))))});$("#begindate").datetimepicker({language:"zh",weekStart:1,todayBtn:1,autoclose:1,todayHighlight:1,startView:2,minView:2,forceParse:0,endDate:new Date,pickerPosition:"bottom-left",format:"yyyy/mm/dd 00:00:00"}).on("change",function(){var n=$("#startDate").val();$("#enddate").datetimepicker("setStartDate",n);$("#filterDate li").removeClass("active");$("#chosen").find("[data-name='filterDate']").remove();$("#startDate").val()!=""?$("#chosen").append('<li class="select active" data-name="filterDate" data-id="'+$("#startDate").val()+'">'+$("#startDate").val()+"<\/li>"):$("#startDate").val()==""&&$("#chosen").append('<li class="select active" data-name="filterDate" data-id="'+$("#startDate").val()+'">'+$("#startDate").val()+"<\/li>")});$("#query_filter_btn,#query_filter_btn2").click(function(){productProcurement.getProcurementPage()});$("#query_like_inputx").keyup(function(){productProcurement.getProcurementPage()});$("#deleteProduct").click(function(){var n=$("#productlist").find('input[name="checkedpurchase"]:checked');if(n.length==1)if(n.data("state")==2||n.data("state")==0)$.post("/supplier/detelesv_procurement",{id:n.data("id"),sate:n.data("state")},function(n){loggin.chklogn(n);n==!0?(layer.msg("\u64cd\u4f5c\u6210\u529f"),productProcurement.getProcurementPage()):n==-2?layer.msg("\u4f60\u6ca1\u6709\u8be5\u64cd\u4f5c\u6743\u9650"):layer.msg("\u64cd\u4f5c\u5931\u8d25")});else return layer.msg("\u53ea\u80fd\u5220\u9664\u3010\u5f85\u5165\u5e93,\u53d6\u6d88\u3011\u72b6\u6001\u7684\u5165\u5e93\u5355,\u8bf7\u91cd\u65b0\u9009\u62e9\u5165\u5e93\u5355\u4fe1\u606f\uff01"),!1;else return layer.msg("\u8bf7\u5148\u62e9\u60a8\u8981\u5220\u9664\u7684\u5165\u5e93\u5355\u4fe1\u606f\uff0c\u81f3\u591a\u53ea\u80fd\u9009\u62e91\u4e2a\uff01"),!1});$("#exportsalesreport").click(function(){var n="",i=$("#query_like_inputx").val(),t=0;$("#chosen>li.active").each(function(){var r=$(this).data("name"),i=$(this).data("id");switch(r){case"filterDay":t=i;break;case"filterDate":n=i}});$.getJSON("/supplier/get_procurement",{date:n,key:i,day:t,top:pageSize,isexport:1},function(n){if(n)try{typeof Cef!="undefined"?Cef.Download(n):location.href=n}catch(t){}})})},addNewPurchase:function(){function r(t){var i=t.id,u=t.isCopy,r=t.type;$.getJSON("/supplier/supplierlist?id=-1&key=",function(n){loggin.chklogn(n);for(var t=0;t<n.length;t++)$("#sv_suid").append('<option value="'+n[t].sv_suid+'">'+n[t].sv_suname+"<\/option>");$("#sv_pc_date").val((new Date).Format("yyyy-MM-dd hh:mm:ss"));i!=""&&i!=null&&i!=undefined&&i.indexOf("DEC")>=0&&u==!1?$("#numbier").text(i):u==!0?$("#numbier").text("DEC"+parseInt(Math.random()*1e12,10)):$("#numbier").text("DEC"+parseInt(Math.random()*1e12,10))});$.get("/WarehouseInfo/GetWarehouse",function(n){var t,i;if(n!=null&&n!=""){t="";is_exist_warehouse=!0;for(i in n)t+=n[i];$("#sv_targetwarehouse_id").html(t)}});(r==1||r==2)&&$.get("/supplier/GetprocUrementoDall?nober="+i,function(t){var u,i,f;for(u in t)$("#"+u).val(t[u]),u=="sv_pc_date"&&$("#"+u).val(new Date(t[u]).Format("yyyy-MM-dd hh:mm:ss")),u=="sv_pc_total"&&$("#zhonge").text(t[u]),u=="sv_pc_combined"&&$("#heji").text(t[u]),u=="sv_pc_realpay"&&$("#shifu").val(t[u]),u=="sv_pc_costs"&&$("#qitafeiyong").val(t[u]);t.prlist&&t.prlist.length>0&&(i="",f=t.prlist,r==1?($.each(f,function(n,t){var r=t.sv_pricing_method==1?t.sv_p_weight:t.sv_pc_pnumber,u;i+='<tr data-sv_pc_productid="'+t.sv_pc_productid+'" data-pid="'+t.product_id+'" data-sv_pricing_method="'+t.sv_pricing_method+'">';i+="<td>"+t.sv_p_barcode+"<\/td>";i+="<td>"+t.sv_p_name+"<\/td>";i+="<td>"+t.sv_p_unit+"<\/td>";i+='<td><input type="text" class="form-control selectpurchaselist productNumber_input" name="" data-pid="'+t.product_id+'" id="product_number_'+t.product_id+'" value="'+r+'" placeholder="\u8f93\u5165\u6570\u91cf"/><\/td>';i+='<td><input type="text" class="form-control selectpurchaselist productPrice_input" name="" data-pid="'+t.product_id+'" id="single_price_'+t.product_id+'" value="'+parseFloat(t.sv_pc_price).toFixed(2)+'" placeholder="\u8f93\u5165\u5355\u4ef7"/><\/td>';i+='<td><input type="text" class="form-control selectpurchaselist" readonly="readonly" name="" data-pid="'+t.product_id+'" id="price_'+t.product_id+'" value="'+parseFloat(t.sv_pc_combined).toFixed(2)+'" placeholder="\u8f93\u5165\u91d1\u989d"/><\/td>';i+='<td><input type="text" class="form-control selectpurchaselist productRevenuePrice_input" name="" data-pid="'+t.product_id+'" id="revenue_'+t.product_id+'" value="'+parseFloat(t.sv_pc_combined).toFixed(2)+'" placeholder="\u8f93\u5165\u5b9e\u6536"/><\/td>';i+='<td><i data-pid="'+t.product_id+'" class="icon-remove-sign deletepurchase"><\/i><\/td>';i+="<\/tr>";checkedProductId[t.product_id]=t.product_id;u={sv_pc_productid:t.sv_pc_productid,product_id:t.product_id,sv_p_barcode:t.sv_p_barcode,sv_p_name:t.sv_p_name,sv_p_originalprice:parseFloat(t.sv_pc_price).toFixed(2),sv_p_unit:t.sv_p_unit,sv_pricing_method:t.sv_pricing_method,sv_pc_pnumber:r};checkedProductValue.push(u)}),$("#product_List").html(i),n()):($.each(f,function(n,t){var u=t.sv_pricing_method==1?t.sv_p_weight:t.sv_pc_pnumber,r;i+='<tr data-sv_pc_productid="'+t.sv_pc_productid+'" data-pid="'+t.product_id+'" data-sv_pricing_method="'+t.sv_pricing_method+'">';i+="<td>"+t.sv_p_barcode+"<\/td>";i+="<td>"+t.sv_p_name+"<\/td>";i+="<td>"+t.sv_p_unit+"<\/td>";i+='<td><input type="text" class="form-control selectpurchaselist productNumber_input" name="" data-pid="'+t.product_id+'" id="product_number_'+t.product_id+'" value="1" placeholder="\u8f93\u5165\u6570\u91cf"/><\/td>';i+='<td><input type="text" class="form-control selectpurchaselist productPrice_input" name="" data-pid="'+t.product_id+'" id="single_price_'+t.product_id+'" value="'+parseFloat(t.sv_pc_price).toFixed(2)+'" placeholder="\u8f93\u5165\u5355\u4ef7"/><\/td>';i+='<td><input type="text" class="form-control selectpurchaselist" readonly="readonly" name="" data-pid="'+t.product_id+'" id="price_'+t.product_id+'" value="'+parseFloat(t.sv_pc_combined).toFixed(2)+'" placeholder="\u8f93\u5165\u91d1\u989d"/><\/td>';i+='<td><input type="text" class="form-control selectpurchaselist productRevenuePrice_input" name="" data-pid="'+t.product_id+'" id="revenue_'+t.product_id+'" value="'+parseFloat(t.sv_pc_combined).toFixed(2)+'" placeholder="\u8f93\u5165\u5b9e\u6536"/><\/td>';i+='<td><i data-pid="'+t.product_id+'" class="icon-remove-sign deletepurchase"><\/i><\/td>';i+="<\/tr>";checkedProductId[t.product_id]=t.product_id;r={sv_pc_productid:t.sv_pc_productid,product_id:t.product_id,sv_p_barcode:t.sv_p_barcode,sv_p_name:t.sv_p_name,sv_p_originalprice:parseFloat(t.sv_pc_price).toFixed(2),sv_p_unit:t.sv_p_unit,sv_pricing_method:t.sv_pricing_method,sv_pc_pnumber:1};checkedProductValue.push(r)}),$("#product_List").html(i),n()))})}function o(){$("#close_layerpage_value").val(layer.index);$.getJSON("/ProductCategory/GetFirstCategory?type=0",function(n){for(var r="",i=0;i<n.length;i++)r+='<li class="click_view" data-id="'+n[i].productcategory_id+'"><i class="icon-stop all"><\/i>'+n[i].sv_pc_name+"<\/li>";t(0,1,"");$("#product_list_info").html(r);$(".click_view").click(function(){$("#checkAll").attr("checked",!1);$(this).addClass("active").siblings().removeClass("active");t($(this).data("id"),1,"")})})}function t(n,i,r){$.getJSON("/AjaxProduct/GetProductList",{category:n,pageIndex:i||1,producttype_id:0,name:r,pageSize:20},function(r){var f=r.list,e="",u,h,o,s,c;if($('.selectcheckbox[data-type="all"]').prop("checked",!1),f.length>0)for(u=0;u<f.length;u++)h=checkedProductId[f[u].product_id],o="",h!=undefined&&(o="checked"),e+='<tr data-pid="'+f[u].product_id+'" data-pricingmethod="'+f[u].sv_pricing_method+'">',e+='<td><input data-pid="'+f[u].product_id+'" data-pricingmethod="'+f[u].sv_pricing_method+'" data-price = '+f[u].sv_p_originalprice+'  type="checkbox" class="checkinput lucky selectcheckbox" name="single" '+o+' value="" style="display:block;width:16px;height:16px;padding-left:0;"/><\/td>',e+="<td>"+(f[u].sv_p_barcode==null?"":f[u].sv_p_barcode)+'<input type="hidden" id="sv_p_barcode_'+f[u].product_id+'" value="'+(f[u].sv_p_barcode==null?"":f[u].sv_p_barcode)+'" /><\/td>',e+="<td><span>"+(f[u].sv_p_name==null?"":f[u].sv_p_name)+'<\/span><input type="hidden" id="product_name_'+f[u].product_id+'" value="'+(f[u].sv_p_name==null?"":f[u].sv_p_name)+'" /><\/td>',e+='<td><i class="colorff">\u00a5'+parseFloat(f[u].sv_p_originalprice).toFixed(2)+"<\/i><\/td>",e+="<td>"+(f[u].sv_p_unit||"\u65e0")+'<input type="hidden" id="sv_p_unit_'+f[u].product_id+'" value="'+(f[u].sv_p_unit||"\u65e0")+'" /><\/td> ',e+="<td>"+f[u].sv_p_specs+"<\/td> ",e+="<\/a><\/tr>";$("#product_tbody").html(e);s=$('.selectcheckbox[name="single"]:checked').length;c=$(".selectcheckbox").length-1;s==c&&s!=0&&$('.selectcheckbox[data-type="all"]').prop("checked",!0);$("#checkedCounts").text(Object.keys(checkedProductId).length);laypage({cont:"pageGro2",pages:r.total,curr:i||1,skin:"molv",skip:!0,first:"\u9996\u9875",last:"\u5c3e\u9875",prev:"\u4e0a\u4e00\u9875",next:"\u4e0b\u4e00\u9875",jump:function(i,r){r||t(n,i.curr)}})})}function i(n){for(var t=0;t<checkedProductValue.length;t++)checkedProductValue[t].product_id==n&&checkedProductValue.splice(t,1)}function u(t){if(t&&t.length>0){var i="";$.each(t,function(n,t){i+='<tr data-sv_pc_productid="'+t.sv_pc_productid+'" data-pid="'+t.product_id+'" data-sv_pricing_method="'+t.sv_pricing_method+'">';i+="<td>"+t.sv_p_barcode+"<\/td>";i+="<td>"+t.sv_p_name+"<\/td>";i+="<td>"+t.sv_p_unit+"<\/td>";i+='<td><input type="text" class="form-control selectpurchaselist productNumber_input" name="" data-pid="'+t.product_id+'" id="product_number_'+t.product_id+'" value="'+(t.sv_pc_pnumber||1)+'" placeholder="\u8f93\u5165\u6570\u91cf"/><\/td>';i+='<td><input type="text" class="form-control selectpurchaselist productPrice_input" name="" data-pid="'+t.product_id+'" id="single_price_'+t.product_id+'" value="'+parseFloat(t.sv_p_originalprice).toFixed(2)+'" placeholder="\u8f93\u5165\u5355\u4ef7"/><\/td>';i+='<td><input type="text" class="form-control selectpurchaselist" readonly="readonly" name="" data-pid="'+t.product_id+'" id="price_'+t.product_id+'" value="'+parseFloat(t.sv_p_originalprice).toFixed(2)+'" placeholder="\u8f93\u5165\u91d1\u989d"/><\/td>';i+='<td><input type="text" class="form-control selectpurchaselist productRevenuePrice_input" name="" data-pid="'+t.product_id+'" id="revenue_'+t.product_id+'" value="'+parseFloat(t.sv_p_originalprice).toFixed(2)+'" placeholder="\u8f93\u5165\u5b9e\u6536"/><\/td>';i+='<td><i data-pid="'+t.product_id+'" class="icon-remove-sign deletepurchase"><\/i><\/td>';i+="<\/tr>"});$("#product_List").html(i);n()}}function s(n){$.getJSON("/AjaxProduct/GetProductDetail_bid?id="+n,function(n){if(n){var t={sv_pc_productid:0,product_id:n.product_id,sv_p_barcode:n.sv_p_barcode,sv_p_name:n.sv_p_name,sv_p_originalprice:n.sv_p_originalprice,sv_p_unit:n.sv_p_unit,sv_pricing_method:n.sv_pricing_method,sv_pc_pnumber:1};i(n.product_id);checkedProductValue.push(t);u(checkedProductValue)}})}function n(){var r=$("#product_List tr"),n=0,t=0,i=parseFloat($("#qitafeiyong").val()||0);$.each(r,function(){var i=$(this).data("pid"),r=parseFloat($("#price_"+i).val()||0),u=parseFloat($("#revenue_"+i).val()||0);n+=r;t+=u});$("#orderTotalAmount").text(n.toFixed(2));$("#allTotalAmount").text((n+i).toFixed(2));$("#allTotalAmountValue").val((t+i).toFixed(2))}function f(n,t){var i=$("#product_List tr"),r="",u,f;i.length>0?(disableButtonById(t),u=i.map(function(){var n=$(this).data("pid");return r=$(this).find("td").eq(1).text(),{sv_pc_productid:$(this).data("sv_pc_productid"),product_id:n,sv_pc_pnumber:$("#product_number_"+n).val(),sv_pc_price:$("#single_price_"+n).val(),sv_pc_combined:$("#price_"+n).val(),sv_pricing_method:$(this).data("sv_pricing_method"),sv_paid_in_amount:$("#revenue_"+n).val()}}).get(),f={sv_pc_noid:$("#numbier").text(),sv_targetwarehouse_id:$("#sv_targetwarehouse_id").val()||-1,sv_suid:$("#sv_suid").val(),sv_pc_date:$("#sv_pc_date").val(),sv_pc_note:$("#sv_pc_note").val(),sv_pc_combined:$("#orderTotalAmount").text(),sv_pc_total:$("#allTotalAmount").text(),sv_pc_costs:$("#qitafeiyong").val(),sv_pc_settlement:$("#sv_pc_settlement").val(),sv_pc_state:n,sv_pc_realpay:$("#allTotalAmountValue").val(),sv_productname:r,Prlist:u},$.ajax({url:"/supplier/addsv_procurement",type:"post",data:JSON.stringify(f),contentType:"application/json",async:!1,success:function(n){loggin.chklogn(n);n==!0?(layer.closeAll(),layer.msg("\u91c7\u8d2d\u8ba2\u5355\u521b\u5efa\u6210\u529f\uff01"),productProcurement.getProcurementPage()):n==-2?(layer.msg("\u4f60\u6ca1\u6709\u8be5\u64cd\u4f5c\u6743\u9650"),enabledButtonById(t)):(layer.closeAll(),layer.msg("\u4fdd\u5b58\u5931\u8d25\uff0c\u8bf7\u5237\u65b0\u91cd\u8bd5\u6216\u68c0\u67e5\u662f\u5426\u6dfb\u52a0\u4f9b\u5e94\u5546\u548c\u4ed3\u5e93\uff01"),enabledButtonById(t))}})):layer.msg("\u8bf7\u9009\u62e9\u91c7\u8d2d\u7684\u5546\u54c1\u5728\u6267\u884c\u6b64\u64cd\u4f5c\uff01")}function h(n){$.get("/supplier/GetprocUrementoDall?nober="+n,function(t){var u,r,i,f;if($("#sholist").empty(),u='<a class="active" href="javascript:void(0)" data-action="GetprocUrementoDall" data-id="'+t.sv_pc_noid+'"><i>'+t.sv_pc_noid+"<\/i>(\u8fdb\u8d27\u5355\u53f7)<\/a>",$("#stockorderinout").html(u),$.get("/supplier/GetPurchasereturnList?associatedCode="+n,function(n){var i,t;if(n&&n.length>0){for(i="",t=0;t<n.length;t++)i+='<option data-action="GetreturnprocUrementoDall" value="'+n[t].sv_pc_noid+'">'+n[t].sv_pc_noid+"<\/option>";$("#stockorderoutid").html(i)}else $("#stockorderoutid_box").hide()}),t==-2)layer.closeAll(),layer.msg("\u4f60\u6ca1\u6709\u8be5\u64cd\u4f5c\u6743\u9650");else{for(r in t)r=="sv_pc_date"?$("#"+r).text(new Date(t[r]).Format("yyyy-MM-dd hh:mm:ss")):$("#"+r).text(t[r]);for(t.Prlist||(t.Prlist=t.prlist),i=0;i<t.Prlist.length;i++)f=t.Prlist[i].sv_pricing_method==1?t.Prlist[i].sv_p_weight:t.Prlist[i].sv_pc_pnumber,$("#sholist").append("<tr> <td><span>"+(i+1)+"<\/span><\/td><td class='amountcolor2'><span>"+t.Prlist[i].sv_p_barcode+"<\/span><\/td> <td><span>"+t.Prlist[i].sv_p_name+"<\/span><\/td> <td><span>"+t.Prlist[i].sv_p_unit+"<\/span><\/td> <td><span>"+f+"<\/span><\/td><td><i>\u00a5"+t.Prlist[i].sv_pc_price+"<\/i><\/td> <td><i class='colorff'>\u00a5"+t.Prlist[i].sv_pc_combined+"<\/i><\/td> <\/tr>")}})}function e(n,t){$("#sholist").empty();$.get("/supplier/"+t+"?nober="+n,function(n){var i,t,r;loggin.chklogn(n);for(i in n)i=="sv_pc_date"?$("#"+i).text(new Date(n[i]).Format("yyyy-MM-dd hh:mm:ss")):$("#"+i).text(n[i]);for(n.Prlist||(n.Prlist=n.prlist),$("#sholist").html(""),t=0;t<n.Prlist.length;t++)r=n.Prlist[t].sv_pricing_method==1?n.Prlist[t].sv_p_weight:n.Prlist[t].sv_pc_pnumber,$("#sholist").append("<tr> <td><span>"+(t+1)+"<\/span><\/td><td class='amountcolor2'><span>"+n.Prlist[t].sv_p_barcode+"<\/span><\/td> <td><span>"+n.Prlist[t].sv_p_name+"<\/span><\/td> <td><span>"+n.Prlist[t].sv_p_unit+"<\/span><\/td> <td><span>"+r+"<\/span><\/td><td><i>\u00a5"+n.Prlist[t].sv_pc_price+"<\/i><\/td> <td><i class='colorff'>\u00a5"+n.Prlist[t].sv_pc_combined+"<\/i><\/td> <\/tr>")})}function c(t){$.get("/supplier/GetprocUrementoDall?nober="+t,function(i){if($("#sv_suid").val(i.sv_suid),$("#sv_orgwarehouse_id").val(i.sv_orgwarehouse_id),i.prlist&&i.prlist.length>0){var r="",u=i.prlist;$.each(u,function(n,t){var i=t.sv_pricing_method==1?t.sv_p_weight:t.sv_pc_pnumber;r+='<tr data-sv_pc_productid="'+t.sv_pc_productid+'" data-pid="'+t.product_id+'" data-sv_pricing_method="'+t.sv_pricing_method+'">';r+="<td>"+t.sv_p_barcode+"<\/td>";r+="<td>"+t.sv_p_name+"<\/td>";r+="<td>"+t.sv_p_unit+"<\/td>";r+='<td><input type="text" class="form-control selectpurchaselist productNumber_input2" name="" data-pid="'+t.product_id+'" id="product_number_'+t.product_id+'" value="'+i+'" placeholder="\u8f93\u5165\u6570\u91cf"/>';r+='<input type="hidden" data-pid="'+t.product_id+'" id="product_number_hidden'+t.product_id+'" value="'+i+'" placeholder=""/><\/td>';r+='<td><input type="text" class="form-control selectpurchaselist" readonly="readonly" name="" data-pid="'+t.product_id+'" id="single_price_'+t.product_id+'" value="'+parseFloat(t.sv_pc_price).toFixed(2)+'" placeholder="\u8f93\u5165\u5355\u4ef7"/><\/td>';r+='<td><input type="text" class="form-control selectpurchaselist" readonly="readonly" name="" data-pid="'+t.product_id+'" id="price_'+t.product_id+'" value="'+parseFloat(t.sv_pc_combined).toFixed(2)+'" placeholder="\u8f93\u5165\u91d1\u989d"/><\/td>';r+='<td class="needdisplaynone"><input type="text" class="form-control selectpurchaselist productRevenuePrice_input" name="" data-pid="'+t.product_id+'" id="revenue_'+t.product_id+'" value="'+parseFloat(t.sv_pc_combined).toFixed(2)+'" placeholder="\u8f93\u5165\u5b9e\u6536"/><\/td>';r+='<td><i data-pid="'+t.product_id+'" class="icon-remove-sign deletepurchase"><\/i><\/td>';r+="<\/tr>"});$("#product_List").html(r);n()}$("#numbier").text(t);$("#orderTotalAmount").text(i.sv_pc_combined);$("#allTotalAmount").text(i.sv_pc_total);$("#allTotalAmountValue").val(i.sv_pc_realpay);$("#sv_pc_note").val(i.sv_remark);$("#qitafeiyong").val(i.sv_pc_costs);$("#sv_pc_settlement").val(i.sv_pc_settlement)})}$("#addpurchase").click(function(){checkedProductValue=[];checkedProductId={};layerpage.Deke_layerpage.getpage2("1","\u65b0\u589e\u91c7\u8d2d","/ajaxHtml_N3/stock/addproductPurchase.html?="+getTimeStamp(),["790px","520px"],r,{id:"",isCopy:!1,type:""})});$(document).unbind("click","#selectProductPurchase").on("click","#selectProductPurchase",function(){layerpage.Deke_layerpage.show_Url2("1","\u9009\u62e9\u65b0\u589e\u8fdb\u8d27\u5546\u54c1","/ajaxHtml_N3/stock/shareSelectProduct.html?="+getTimeStamp(),["790px","582px"],o)});$(document).unbind("click",".selectcheckbox").on("click",".selectcheckbox",function(){var h=$(this).attr("data-type"),t,r,u,e,n,f,o,s;h=="all"?(t=$(this).is(":checked"),t?($("#product_tbody").find('.selectcheckbox[name="single"]').prop("checked",!0),$('#product_tbody .selectcheckbox[name="single"]').each(function(){var n=$(this).data("pid"),r=$(this).data("sv_p_storage"),t;checkedProductId[n]=n;t={sv_pc_productid:0,product_id:n,sv_p_barcode:$("#sv_p_barcode_"+n).val(),sv_p_name:$("#product_name_"+n).val(),sv_p_originalprice:$(this).data("price"),sv_p_unit:$("#sv_p_unit_"+n).val(),sv_pricing_method:$(this).data("pricingmethod"),sv_pc_pnumber:1};i(n);checkedProductValue.push(t)})):($("#product_tbody").find('.selectcheckbox[name="single"]').prop("checked",!1),$('#product_tbody .selectcheckbox[name="single"]').each(function(){var n=$(this).data("pid"),t=$(this).data("sv_p_storage");delete checkedProductId[n];i(n)}))):(r=$(this).is(":checked"),u=$('.selectcheckbox[data-type="all"]').is(":checked"),r?(n=$(this).data("pid"),f=$(this).data("sv_p_storage"),checkedProductId[n]=n,e={sv_pc_productid:0,product_id:n,sv_p_barcode:$("#sv_p_barcode_"+n).val(),sv_p_name:$("#product_name_"+n).val(),sv_p_originalprice:$(this).data("price"),sv_p_unit:$("#sv_p_unit_"+n).val(),sv_pricing_method:$(this).data("pricingmethod"),sv_pc_pnumber:1},checkedProductValue.push(e)):(n=$(this).data("pid"),f=$(this).data("sv_p_storage"),delete checkedProductId[n],i(n)),u?$('.selectcheckbox[data-type="all"]').prop("checked",!1):(o=$('.selectcheckbox[name="single"]:checked').length,s=$(".selectcheckbox").length-1,o==s&&$('.selectcheckbox[data-type="all"]').prop("checked",!0)));$("#checkedCounts").text(Object.keys(checkedProductId).length)});$(document).unbind("keypress","#gysName").on("keypress","#gysName",function(n){n.keyCode==13&&t(0,1,$("#gysName").val())});$(document).unbind("click","#query_gysName").on("click","#query_gysName",function(){t(0,1,$("#gysName").val())});$(document).unbind("click","#determineSelectProductBtn").on("click","#determineSelectProductBtn",function(){var t=$("#product_tbody").find('.selectcheckbox[name="single"]:checked'),n=Object.keys(checkedProductId).length;n<1?layer.msg("\u5f53\u524d\u6ca1\u6709\u9009\u62e9,\u8bf7\u9009\u62e9\u5546\u54c1!"):(layer.close($("#close_layerpage_value").val()),u(checkedProductValue))});$(document).unbind("keypress","#productInfoId").on("keypress","#productInfoId",function(n){n.keyCode==13&&s($(this).val())});$(document).unbind("click","#product_List .deletepurchase").on("click","#product_List .deletepurchase",function(){var t=$(this).data("pid");delete checkedProductId[t];i(t);$("#product_List").find('tr[data-pid="'+t+'"]').remove();n()});$(document).unbind("keyup","#product_List .productNumber_input").on("keyup","#product_List .productNumber_input",function(){shareClearNoNum(this);var t=$(this).data("pid"),i=parseFloat($("#single_price_"+t).val()),r=parseFloat($(this).val());$("#price_"+t).val(parseFloat(i*r||0).toFixed(2));$("#revenue_"+t).val(parseFloat(i*r||0).toFixed(2));n()});$(document).unbind("keyup","#product_List .productPrice_input").on("keyup","#product_List .productPrice_input",function(){shareClearNoNum(this);var t=$(this).data("pid"),i=parseFloat($("#product_number_"+t).val()),r=parseFloat($(this).val());$("#price_"+t).val(parseFloat(i*r||0).toFixed(2));$("#revenue_"+t).val(parseFloat(i*r||0).toFixed(2));n()});$(document).unbind("keyup","#product_List .productRevenuePrice_input").on("keyup","#product_List .productRevenuePrice_input",function(){n()});$(document).unbind("keyup","#qitafeiyong").on("keyup","#qitafeiyong",function(){n()});shareSmallWindowFn(".determinePurchaseBtn",null,"\u5165\u5e93\u5ba1\u6838",null,'<div class="determine"><p>\u3010\u5165\u5e93\u5e76\u5ba1\u6838\u3011\u8d27\u54c1\u4f1a\u76f4\u63a5\u6dfb\u52a0\u5230\u7cfb\u7edf\u5e93\u5b58<br>\u3010\u4fdd\u5b58\u3011\u786e\u8ba4\u5ba1\u6838\u6536\u8d27\u540e\u624d\u4f1a\u6dfb\u52a0\u5230\u7cfb\u7edf\u5e93\u5b58<\/p><\/div><footer class="determinebtn-closebtn"><div class="btnbox fr"><button data-sate="0" type="button" class="btn btn-success" id="determinePurchaseBtn">\u4fdd\u5b58<\/button><button data-sate="1" type="button" class="btn btn-success" id="determinePurchaseBtnByAddPurchase">\u5165\u5e93\u5e76\u5ba1\u6838<\/button><button type="button" class="btn btn-default closepage">\u53d6\u6d88<\/button><\/div><\/footer>');$(document).unbind("click","#determinePurchaseBtn").on("click","#determinePurchaseBtn",function(){f(0,"determinePurchaseBtn")});$(document).unbind("click","#determinePurchaseBtnByAddPurchase").on("click","#determinePurchaseBtnByAddPurchase",function(){f(1,"determinePurchaseBtnByAddPurchase")});$(document).unbind("click","#productlist .shareOperatingBtn").on("click","#productlist .shareOperatingBtn",function(){var n=$(this).data("id"),t=$(this).data("sate");$.post("/supplier/updatesv_procurement",{id:n,sate:t},function(n){loggin.chklogn(n);n==!0?(layer.msg("\u64cd\u4f5c\u6210\u529f"),productProcurement.getProcurementPage()):n==-1?layer.msg("\u8be5\u5355\u636e\u5df2\u7ecf\u5ba1\u6838\u8fc7"):n==-2?layer.msg("\u4f60\u6ca1\u6709\u8be5\u64cd\u4f5c\u6743\u9650"):layer.msg("\u64cd\u4f5c\u5931\u8d25")})});$(document).unbind("click","#productlist .editpurchase").on("click","#productlist .editpurchase",function(){checkedProductValue=[];checkedProductId={};var n=$(this).data("purchase_id"),t={id:n,isCopy:!1,type:1};layerpage.Deke_layerpage.getpage2("1","\u65b0\u589e\u91c7\u8d2d","/ajaxHtml_N3/stock/addproductPurchase.html?="+getTimeStamp(),["790px","520px"],r,t)});$(document).unbind("click","#productlist .copypurchase").on("click","#productlist .copypurchase",function(){checkedProductValue=[];checkedProductId={};var n=$(this).data("purchase_id"),t={id:n,isCopy:!0,type:2};layerpage.Deke_layerpage.getpage2("1","\u590d\u5236\u65b0\u589e\u91c7\u8d2d","/ajaxHtml_N3/stock/addproductPurchase.html?="+getTimeStamp(),["790px","520px"],r,t)});$(document).unbind("click","#productlist .purchaseRetuenDetails").on("click","#productlist .purchaseRetuenDetails",function(){var n=$(this).data("purchase_id");layerpage.Deke_layerpage.show_Url2("1","\u91c7\u8d2d\u6e05\u5355","/ajaxHtml_N3/stock/purchaseReturnDetails2.html?="+getTimeStamp(),["790px","520px"],h(n))});$(document).unbind("click","#stockorderinout>a").on("click","#stockorderinout>a",function(){$(this).addClass("active").siblings("a").removeClass("active");var n=$(this).data("id"),t=$(this).data("action");e(n,t)});$(document).unbind("change","#stockorderoutid").on("change","#stockorderoutid",function(){$("#stockorderinout>a").removeClass("active");var n=$(this).val(),t=$("#stockorderoutid option:checked").attr("data-action");e(n,t)});$(document).unbind("click","#productlist .returnPurchaseGoods").on("click","#productlist .returnPurchaseGoods",function(){var n=$(this).data("purchase_id");layerpage.Deke_layerpage.show_Url2("1","\u91c7\u8d2d\u9000\u8d27","/ajaxHtml_N3/stock/returnPurchaseProduct.html?="+getTimeStamp(),["790px","520px"],c(n))});$(document).unbind("keyup","#product_List .productNumber_input").on("keyup","#product_List .productNumber_input2",function(){var i,r;shareClearNoNum(this);var t=$(this).data("pid"),f=parseFloat($(this).val()||0),u=parseFloat($("#product_number_hidden"+t).val());f>u&&($(this).val(u),layer.msg("\u8f93\u5165\u7684\u6570\u91cf\u5927\u4e8e\u5f53\u524d\u91c7\u8d2d\u5546\u54c1\u7684\u6570\u91cf\u503c\uff01"));i=$("#product_number_"+t).val();r=parseFloat($("#single_price_"+t).val());$("#price_"+t).val(parseFloat(r*i||0).toFixed(2));$("#revenue_"+t).val(parseFloat(r*i||0).toFixed(2));n()});$(document).unbind("click","#confirmPurchaseReturnBtn").on("click","#confirmPurchaseReturnBtn",function(){var t=$("#product_List tr"),n=!0,i="",r,u;if(t.length<1){layer.msg("\u6ca1\u6709\u4efb\u4f55\u53ef\u9000\u7684\u7269\u54c1\uff01");return}r=t.map(function(){var t=$(this).data("pid"),r=parseFloat($("#product_number_"+t).val()),u=$(this).find("td").eq(1).text()+","+$(this).find("td").eq(0).text()+",",f=parseFloat($("#product_number_hidden"+t).val()),e=$("#single_price_"+t).val(),o=$("#price_"+t).val(),s=$(this).data("sv_pricing_method");if(r<1){layer.msg(u+"\u9000\u8d27\u6570\u5fc5\u987b\u586b\u5199\u5927\u4e8e\u96f6");n=!1;return}if(f<r){layer.msg(u+"\u6700\u591a\u53ef\u9000\u3010"+f+"\u3011");n=!1;return}return i+=u,{product_id:t,sv_pc_pnumber:r,sv_pc_price:e,sv_pc_combined:o,sv_pricing_method:s}}).get();u={sv_pc_noid:"DETH"+(new Date).Format("yyyyMMddhhmmssS"),sv_orgwarehouse_id:$("#sv_orgwarehouse_id").val()||-1,sv_pc_Operation:$("#sv_pc_Operation").val(),sv_suid:$("#sv_suid").val(),sv_pc_date:$("#sv_pc_date").val(),sv_pc_note:$("#sv_pc_note").val(),sv_pc_combined:$("#orderTotalAmount").text(),sv_pc_total:$("#allTotalAmount").text(),sv_pc_costs:$("#qitafeiyong").val(),sv_pc_settlement:$("#sv_pc_settlement").val(),sv_pc_state:1,sv_pc_realpay:$("#allTotalAmountValue").val(),sv_productname:i,sv_associated_code:$("#numbier").text(),Prlist:r};n&&(disableButtonById("confirmPurchaseReturnBtn"),$.ajax({url:"/supplier/addsv_purchasereturn",type:"post",data:JSON.stringify(u),contentType:"application/json",async:!1,success:function(n){loggin.chklogn(n);n>0?(layer.closeAll(),layer.msg("\u9000\u8d27\u6210\u529f\uff01"),productProcurement.getProcurementPage()):n==-3?layer.msg("\u5176\u4e2d\u6709\u4ea7\u54c1\u5df2\u7ecf\u5931\u6548\uff01"):n==-6?layer.msg("\u4ed3\u5e93\u4e0d\u5b58\u5728\uff01"):n==-4?layer.msg("\u5f53\u524d\u4ed3\u5e93\u4e0d\u5b58\u5728\u8be5\u5546\u54c1\uff01"):n==-7||n==-2?layer.msg("\u9000\u8d27\u5931\u8d25\uff0c\u6709\u4ea7\u54c1\u5e93\u5b58\u4e0d\u8db3\uff01"):n==-8?layer.msg("\u586b\u5199\u7684\u9000\u8d27\u6570\u91cf\u90fd\u662f\u96f6\uff01"):n==-9?layer.msg("\u83b7\u53d6\u4ed3\u5e93\u7c7b\u578b\u5931\u8d25\uff01"):(layer.closeAll(index),layer.msg("\u9000\u8d27\u5931\u8d25\uff01"));enabledButtonById("confirmPurchaseReturnBtn")}}))})}};